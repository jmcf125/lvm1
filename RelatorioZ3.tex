\documentclass[a4paper,12pt]{article}
\begin{document}
\title{Projeto 1: SAT}
\author{João Miguel \and Rui Breda}
\date{\today}
\maketitle
\section{Sudoku}
\subsection{Classic Sudoku}
\paragraph{Descrição do problema \newline}
Este exercício do projeto consistiu na modelação e redução do problema do sudoku para SAT. Este problema consiste no seguinte: dado um tabuleiro inicial 9x9, preencher todas as células do tabuleiro com números de 1 a 9 tal que nenhum número se repita na mesma linha, coluna e região (quadrado 3x3).
\paragraph{Símbolos Proposicionais \newline}
Uma abordagem à resolução deste problema através do SAT-solver z3 implica que este seja descrito como fórmulas de símbolos proposicionais em CNF (Conjunctive Normal Form). Fórmulas estas que serão testadas face diversas atribuições aos símbolos proposicionais.\newline

Uma vez que se pretende explicitar que nenhuma célula pode ter um número já presente na mesma linha, coluna e região, o número de símbolos proposicionais não poderia ser inferior a 9$\times$9. Como o domínio onde trabalhamos é booleano, cada número que as células podem ter terá que ser um símbolo proposicional, com o valor verdadeiro se o número se encontra na célula e falso caso contrário.\newline
 
Portanto, haverá no total um símbolo por cada célula e por cada número possível, resultando em 9$\times$9$\times$9 símbolos. Assim, os símbolos terão a forma p\textunderscore i\textunderscore j\textunderscore n, 0 $\leq$ i $\leq$ 8 , 0 $\leq$ j $\leq$ 8 e 1 $\leq$ n $\leq$ 9 com i e j os índices da célula no tabuleiro e n um número possível de 1 a 9.
\paragraph{Condições e restrições \newline}
Estabelecidos os símbolos proposicionais, é necessário descrever o problema em termos de condições e restrições às quais este será sujeito.
Como foi referido anteriormente, cada célula necessita de ter um e um só número. Esta condição pode ser dividida em duas:\newline
\begin{itemize}
	\item
	Cada célula tem pelo menos um número, ou seja, os símbolos da respetiva célula e dos diversos números não podem ser todos simultaneamente falsos
	
	\begin{displaymath}
	\
	\bigwedge_{0\leq i,j < 9} \bigvee_{1\leq n \leq 9} p \textunderscore i \textunderscore j \textunderscore n
	\end{displaymath}
	
	 \item Cada célula tem no máximo um número. A presença desta condição é justificada pelo facto de, se houver mais do que um número por célula, os restantes números da linha, coluna e região serão influenciados.
	
	\begin{displaymath}
	\
	\bigwedge_{0\leq i,j < 9} \bigwedge_{1\leq k < m \leq 9} \lnot p \textunderscore i \textunderscore j \textunderscore k \bigvee \lnot p \textunderscore i \textunderscore j \textunderscore m
	\end{displaymath}
	
	\item Feitas as condições para as células, é necessário implementar as restrições que ditam as regras do puzzle.
	As seguintes restrições  indicam que uma linha e uma coluna não podem ter um número repetido, com a única diferença entre as duas ser os índices de p.
	
	\begin{displaymath}
	\
	\bigwedge_{0\leq i < 9} \bigwedge_{1\leq k \leq 9} \bigwedge_{0\leq j < m < 9} \lnot p \textunderscore i \textunderscore j \textunderscore k \bigvee \lnot p \textunderscore i \textunderscore m \textunderscore k
	\end{displaymath}
	
	\begin{displaymath}
	\
	\bigwedge_{0\leq i < 9} \bigwedge_{1\leq k \leq 9} \bigwedge_{0\leq j < m < 9} \lnot p \textunderscore j \textunderscore i \textunderscore k \bigvee \lnot p \textunderscore m \textunderscore i \textunderscore k
	\end{displaymath}
	
	
	\item Adicionalmente a não haver repetições de números por linha e coluna, é preciso garantir que nenhum número se repete por região. Portanto, dado um determinado p\textunderscore i\textunderscore j\textunderscore k, os símbolos da mesma região que não estão na mesma linha e coluna (não foram abrangidos pelas condições anteriores) não poderão ter o mesmo número. Nesta expressão, c é o índice da primeira coluna da região e b = i+(2 - i $\bmod$ 3), que representa o índice da última linha da região.
	
	\begin{displaymath}
	\
	\bigwedge_{0\leq i < 9} \bigwedge_{1\leq k \leq 9} \bigwedge_{0\leq j < 9} \bigwedge_{i + 1 \leq n < b} \bigwedge_{c\leq l < c+3} \lnot p \textunderscore i\textunderscore j\textunderscore k \bigvee \lnot p \textunderscore n \textunderscore l \textunderscore k
	\end{displaymath}
	
	\item Por fim, é necessário adicionar como condição os números já presentes no tabuleiro inicial que se pretende resolver. Assim, dado um conjunto S com os símbolos proposicionais correspondentes aos números das células do tabuleiro inicial: 
	
	\begin{displaymath}
	\
	\bigwedge_{p\in S} p
	\end{displaymath}
	
	\item Em função de se poder "eliminar" soluções específicas , como é o caso da função well\textunderscore posed(P), estabelece-se a seguinte restrição: dado um conjunto M com os símbolos de uma solução (ou seja com valor verdadeiro):
	
	\begin{displaymath}
	\
	\bigvee_{p\in M} \lnot p
	\end{displaymath}
	
\end{itemize}
\paragraph{Funções \newline}
A implementação recorreu a três funções principais: sudoku(), well\textunderscore posed() e generate().

\paragraph{}
A função sudoku() gera os símbolos proposicionais, aplica as restrições indicadas e verifica se existe solução.

\paragraph{}
A função well\textunderscore posed(P) corre sudoku(P) para resolver o tabuleiro P e gera o conjunto de símbolos proposicionais da resposta. De seguida, corre sudoku(P) outravez, que agora aplica a restrição mencionada anteriormente. Caso a verificação resulte em unsat, então o tabuleiro possui apenas uma solução, pelo que é well\textunderscore posed.

\paragraph{}
A função generate(S, pat) remove os elementos de S de acordo com o padrão e chama a função well\textunderscore posed() com o resultado.

\subsection{}




\end{document}